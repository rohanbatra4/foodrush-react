{"ast":null,"code":"import express from \"express\";\nimport fetch from \"node-fetch\";\nimport path from \"path\";\nconst __dirname = path.resolve();\nconst app = express();\nconst getAccessToken = async () => {\n  const clientId = \"<test>\";\n  const appSecret = \"<test_secret>\";\n  const url = \"https://api-m.sandbox.paypal.com/v1/oauth2/token\";\n  const response = await fetch(url, {\n    body: \"grant_type=client_credentials\",\n    method: \"POST\",\n    headers: {\n      Authorization: \"Basic \" + Buffer.from(clientId + \":\" + appSecret).toString(\"base64\")\n    }\n  });\n  const data = await response.json();\n  return data.access_token;\n};\nconst createOrder = async () => {\n  const url = \"https://api-m.sandbox.paypal.com/v2/checkout/orders\";\n  const payload = {\n    intent: \"CAPTURE\",\n    purchase_units: [{\n      amount: {\n        currency_code: \"USD\",\n        value: \"0.02\"\n      }\n    }]\n  };\n  const headers = {\n    Authorization: `Bearer ${await getAccessToken()}`,\n    \"Content-Type\": \"application/json\"\n  };\n  const response = await fetch(url, {\n    headers,\n    method: \"POST\",\n    body: JSON.stringify(payload)\n  });\n  const data = await response.json();\n  if (data.error) {\n    throw new Error(error);\n  }\n  return data;\n};\nconst capturePayment = async orderID => {\n  const url = `https://api-m.sandbox.paypal.com/v2/checkout/orders/${orderID}/capture`;\n  const headers = {\n    Authorization: `Bearer ${await getAccessToken()}`,\n    \"Content-Type\": \"application/json\"\n  };\n  const response = await fetch(url, {\n    headers,\n    method: \"POST\"\n  });\n  const data = await response.json();\n  if (data.error) {\n    throw new Error(error);\n  }\n  return data;\n};\napp.get(\"/\", (req, res) => {\n  res.sendFile(`${__dirname}/index.html`);\n});\napp.post(\"/orders\", async (req, res) => {\n  const response = await createOrder();\n  res.json(response);\n});\napp.post(\"/orders/:orderID/capture\", async (req, res) => {\n  const response = await capturePayment(req.params.orderID);\n  res.json(response);\n});\napp.listen(9597, () => {\n  console.log(\"listening on http://localhost:9597/\");\n});","map":{"version":3,"names":["express","fetch","path","__dirname","resolve","app","getAccessToken","clientId","appSecret","url","response","body","method","headers","Authorization","Buffer","from","toString","data","json","access_token","createOrder","payload","intent","purchase_units","amount","currency_code","value","JSON","stringify","error","Error","capturePayment","orderID","get","req","res","sendFile","post","params","listen","console","log"],"sources":["/Users/rohanbatra/Desktop/Projects/foodrush-react/src/modules/payment.jsx"],"sourcesContent":["\nimport express from \"express\";\nimport fetch from \"node-fetch\";\nimport path from \"path\";\nconst __dirname = path.resolve();\n\nconst app = express();\nconst getAccessToken = async () => {\n  const clientId = \"<test>\";\n  const appSecret = \"<test_secret>\";\n  const url = \"https://api-m.sandbox.paypal.com/v1/oauth2/token\";\n  const response = await fetch(url, {\n    body: \"grant_type=client_credentials\",\n    method: \"POST\",\n    headers: {\n      Authorization:\n        \"Basic \" + Buffer.from(clientId + \":\" + appSecret).toString(\"base64\"),\n    },\n  });\n  const data = await response.json();\n  return data.access_token;\n};\n\nconst createOrder = async () => {\n  const url = \"https://api-m.sandbox.paypal.com/v2/checkout/orders\";\n  const payload = {\n    intent: \"CAPTURE\",\n    purchase_units: [\n      {\n        amount: {\n          currency_code: \"USD\",\n          value: \"0.02\",\n        },\n      },\n    ],\n  };\n  const headers = {\n    Authorization: `Bearer ${await getAccessToken()}`,\n    \"Content-Type\": \"application/json\",\n  };\n  const response = await fetch(url, {\n    headers,\n    method: \"POST\",\n    body: JSON.stringify(payload),\n  });\n  const data = await response.json();\n  if (data.error) {\n    throw new Error(error);\n  }\n  return data;\n};\n\nconst capturePayment = async (orderID) => {\n  const url = `https://api-m.sandbox.paypal.com/v2/checkout/orders/${orderID}/capture`;\n  const headers = {\n    Authorization: `Bearer ${await getAccessToken()}`,\n    \"Content-Type\": \"application/json\",\n  };\n  const response = await fetch(url, {\n    headers,\n    method: \"POST\",\n  });\n  const data = await response.json();\n  if (data.error) {\n    throw new Error(error);\n  }\n  return data;\n};\n\napp.get(\"/\", (req, res) => {\n  res.sendFile(`${__dirname}/index.html`);\n});\n\napp.post(\"/orders\", async (req, res) => {\n  const response = await createOrder();\n  res.json(response);\n});\n\napp.post(\"/orders/:orderID/capture\", async (req, res) => {\n  const response = await capturePayment(req.params.orderID);\n  res.json(response);\n});\n\napp.listen(9597, () => {\n  console.log(\"listening on http://localhost:9597/\");\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}